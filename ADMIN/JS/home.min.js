var firebaseConfig = {
    apiKey: "AIzaSyCOA_2bf_b1o1nXSHZO5Re5DjSD66Pa6MY",
    authDomain: "https://raona0-default-rtdb.firebaseio.com",
    projectId: "raona0",
    storageBucket: "raona0.appspot.com",
    messagingSenderId: "797719983777",
    appId: "1:797719983777:web:d7ffca1316891b51ec62e0"
  };

// Initialize Firebase
firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.firestore();
const userList = document.getElementById("userList");
const orderCount = document.getElementById("orderCount");
const userCount = document.getElementById("userCount");

async function displayUserList() {
    userList.innerHTML = "";
  
    try {
      const usersSnapshot = await firebase.firestore().collection("").get();
  
      console.log("usersSnapshot:", usersSnapshot); // Log the usersSnapshot data
  
      usersSnapshot.forEach(doc => {
        const user = doc.data();
        console.log("user:", user); // Log the user data
  
        const listItem = document.createElement("li");
        listItem.innerHTML = `
          <span>${user.username}</span>
          <button onclick="banUser('${user.username}')">Ban</button>
        `;
        console.log("listItem:", listItem); // Log the created list item
  
        userList.appendChild(listItem);
      });
  
      userCount.textContent = usersSnapshot.size;
    } catch (error) {
      console.error("Error fetching user list:", error);
    }
  }
  

async function banUser(userId) {
  const result = await Swal.fire({
    title: 'Are you sure?',
    text: 'This user will be banned!',
    icon: 'warning',
    showCancelButton: true,
    confirmButtonText: 'Ban',
    cancelButtonText: 'Cancel',
  });

  if (result.isConfirmed) {
    try {
      await db.collection('users').doc(userId).update({
        banned: true,
      });
      Swal.fire('Banned!', 'The user has been banned.', 'success');
    } catch (error) {
      console.error('Error banning user:', error);
      Swal.fire('Error', 'An error occurred while banning the user.', 'error');
    }
  }
}
async function fetchOrderCount() {
    try {
      const ordersSnapshot = await firebase.firestore().collection("orders").get();
      orderCount.textContent = ordersSnapshot.size;
    } catch (error) {
      console.error("Error fetching order count:", error);
    }
  }
  
  displayUserList();
  fetchOrderCount();